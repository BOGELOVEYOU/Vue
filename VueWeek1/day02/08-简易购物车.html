<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title></title>
</head>
<body>

<div id="app">

	{{allFlag}}  -- {{arrs}}
	<table border="1">
		<thead>
			<tr>
				<th>
					<!-- click  获取之前的状态 allFlag
						change 获取改变后的状态  allFlag
					 -->
					<input type="checkbox" v-model="allFlag" @change="checlAll">
				</th>
				<th>id</th>
				<th>名称</th>
				<th>价格</th>
				<th>操作</th>
				<th>小计</th>
			</tr>
		</thead>
		<tbody>
			<tr v-for="(item,index) in cart" :key="item.id">
				<td>
					<input type="checkbox" @change="single" v-model="arrs" :value="item.id">
				</td>
				<td>{{item.id}}</td>
				<td>{{item.name}}</td>
				<td>{{item.price}}</td>
				<td>
					<button :disabled="item.num<=1" @click="sub(item)">-</button>	
					{{item.num}}
					<button @click="add(item)">+</button>	
					<button @click="del(index,item)">x</button>	
				</td>
				<td>{{item.price*item.num}}</td>
			</tr>
		</tbody>
	</table>
</div>

<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
<script type="text/javascript">
	
	var cartData = [ { 
		id: 1, 
		  name: '小米', 
		  price: 100, 
		  num: 1
		}, { 
		  id: 2, 
		  name: '华为', 
		  price: 200, 
		  num: 1 
		},{ 
		  id: 3, 
		  name: '联想',
		  price: 300, 
		  num: 1 
		} ]

	var app = new Vue({
		el:'#app',
		data:{
			cart:cartData,
			allFlag:false,  // 全选框的标识
			arrs:[]  // 单选的标识
		},
		methods:{
			add(goods){
				// console.log(goods)
				goods.num++
			},
			sub(goods){
				goods.num--
			},
			del(idx,goods){
				// console.log('xxx')
				// console.log(idx)

				this.cart.splice(idx,1);

				// goods.id   this.arrs
				var a = this.arrs.indexOf(goods.id); //删除的时候判断一下有没有选中
				if(a>-1){
					this.arrs.splice(a,1)
				}


			},
			checlAll(){
				console.log(this.allFlag)

				if(this.allFlag){  //是否选中 true就是选中
					for(var i=0; i<this.cart.length;i++){  // 遍历cart
						this.arrs.push(this.cart[i].id)   // cart中的id添加到arrs
					} 
				}else{
					this.arrs = []  //未选中的状态 就是arrs清空
				}
			},
			single(){
				// console.log( this.cart.length == this.arrs.length);
				// this.allFlag = this.cart.length == this.arrs.length


				// 点击单选按钮，判断cart长度和arrs的长度
				if(this.cart.length == this.arrs.length){ //如果相等
					this.allFlag = true  // 就把全选按钮勾选上
				}else{
					this.allFlag = false  // 否则就是不勾选
				}
			}
		}
	})
</script>
</body>
</html>