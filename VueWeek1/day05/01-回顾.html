<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title></title>
</head>
<body>


<script type="text/javascript" src="./node_modules/axios/dist/axios.js"></script>
<script type="text/javascript">
	
	// 原生ajax  xhr  兼容性不好  操作步骤比较多

	// jq ajax  对原生ajax的封装，使用就比较简单了，  jq还包含其他的库，文件就比较大了

	// fetch html5提供新的api, 基于promise, 使用也很简单

	// axios 可以运行在服务器中，也可以运行在中浏览器中， 也是对不同的原生的api进行了封装
	// 自定义能力强
	// 可以拦截请求和响应 并且做处理


	// 全局配置
	// 全局配置根地址
	axios.defaults.baseURL = 'http://121.89.205.189/admin/';

	// 配置token
	axios.defaults.headers.common['token'] = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhZG1pbm5hbWUiOiJhZG1pbiIsImlhdCI6MTYzNTQ2Nzc4OCwiZXhwIjoxNjM1NDk2NTg4fQ.YDFqDUlEs06Sot4U78VqHsKliB6t5-NPnZf7mOvjAnU';


	/*
		get请求： 

		参数1 ：url
		参数2 ： 需要传递的参数  {params:{}}
		axios.get('url').then(res=>{}).catch(err=>{})
		
	*/ 
	// get请求传递的参数才需要加上params
	// axios.get('order/statusList',{params:{status:1}}).then(res=>{
	// 	console.log(res)
	// })
	

	// post
	/*
		
		参数1：url
		参数2： data
			data类型有好几种

			form-data //通过是用来上传文件的  !!
			x-www-form-urlencoded  // 表单类型  !!  name=young&age=18

			raw // 可以指定更多的类型
			binary //上传文件
			GraphQL 

		axios.post('url',data).then(res=>{}).catch(err=>{})

	*/  

	// axios.post('admin/login','adminname=admin&password=123456').then(res=>{
	// 	console.log(res)
	// })


	// 请求拦截
	// 在发送接口之前做一些处理
	axios.interceptors.request.use(function(config){
		// console.log(config)
		"{adminname:'admin',password:'123456'} => 'adminname=admin&password=123456'"
		var data = config.data;

		var params = '';
		for(item in data){
			params += item+'='+data[item]+'&'
		}

		params = params.substring(0,params.length-1)
		console.log(params)
		config.data = params
		return config;
	})



	// 响应拦截
	// 接口请求成功之后做一些拦截处理
	axios.interceptors.response.use(function(res){
		console.log(res)


		if(res.data.code != 200){
			alert('接口异常')
		}

		// res.data.code  //所有的接口返回的code为200，就说明请求成功，其他的就说明就异常了
		return res;
	})


	// http://121.89.205.189/admin/admin/login
	// 接口是可以传递对象的
	axios.post('admin/login',{adminname:'admin',password:'123456'}).then(res=>{
		console.log(res)
	})







</script>
</body>
</html>